@page
@model CinemaBookingRazor.Pages.IndexModel
@{
    ViewData["Title"] = "Home";
}

<section class="py-4 mb-4" style="background: linear-gradient(90deg,#f8fafc,#ffffff);">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-8">
                <h1 class="display-5">Welcome to CinemaBooking</h1>
                <p class="lead">Find showtimes, choose seats and book tickets quickly. Enjoy the latest movies.</p>
                <!-- hero buttons removed to avoid duplicate login; use right sign-in card -->
            </div>
            <div class="col-md-4 text-md-end d-none d-md-block">
                <img src="~/img/cinema-hero.png" alt="cinema" style="max-width:220px;opacity:.95" />
            </div>
        </div>
    </div>
</section>

<div class="container mb-5">
    <div class="row">
        <div class="col-lg-9">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h3>Now Showing</h3>
                <small class="text-muted">Updated frequently</small>
            </div>

            <div class="row">
                @if (!Model.Movies.Any())
                {
                    <div class="col-12">
                        <div class="alert alert-info">No movies available.</div>
                    </div>
                }
                else
                {
                    foreach (var m in Model.Movies)
                    {
                        <div class="col-sm-6 col-md-4 mb-4">
                            <div class="card h-100 shadow-sm">
                                <img src="@(string.IsNullOrWhiteSpace(m.PosterUrl) ? "/img/no-poster.png" : m.PosterUrl)" class="card-img-top" alt="@m.Title" style="height:320px;object-fit:cover" />
                                <div class="card-body d-flex flex-column">
                                    <h5 class="card-title">@m.Title</h5>
                                    <p class="card-text mb-1 text-muted">@m.Genre</p>
                                    <p class="card-text mb-2"><small class="text-muted">@((m.Duration ?? 0)) mins</small></p>
                                    <div class="mt-auto d-flex justify-content-between align-items-center">
                                        <strong class="text-primary">@((m.Price.HasValue) ? $"{m.Price:0,#}" : "-")</strong>
                                        <a class="btn btn-sm btn-primary" asp-page="/Showtime/Index" asp-route-movieId="@m.Id">View times</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                }
            </div>
        </div>

        <div class="col-lg-3">
            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    @if (User?.Identity?.IsAuthenticated == true)
                    {
                        <h5 class="card-title">Welcome back</h5>
                        <p class="mb-2">Hello, @User.Identity.Name</p>
                        <a class="btn btn-outline-secondary btn-sm me-2" asp-page="/Bookings/MyBookings">My bookings</a>
                        <form method="post" asp-page-handler="Logout" class="d-inline">
                            <button type="submit" class="btn btn-danger btn-sm">Logout</button>
                        </form>
                    }
                    else
                    {
                        <h5 class="card-title">Sign in</h5>
                        <p class="text-muted small">Login to manage bookings and access member prices.</p>
                        <a class="btn btn-primary btn-sm w-100 mb-2" asp-page="/Account/Login">Login</a>
                        <a class="btn btn-outline-secondary btn-sm w-100" asp-page="/Account/Register">Register</a>
                    }
                </div>
            </div>

            <div class="card shadow-sm">
                <div class="card-body">
                    <h6 class="card-title">Promotions</h6>
                    <p class="small text-muted mb-2">Check latest discounts and combos.</p>
                    <a class="btn btn-outline-primary btn-sm" href="#">View offers</a>
                </div>
            </div>
        </div>
    </div>
</div>